<!DOCTYPE html>
<html lang="ja">
<head>
  <link rel="preload" href="/mlops-practices/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/mlops-practices/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/mlops-practices/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/mlops-practices/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Standard ML notes | MLOps - Practices</title>
  <link rel = 'canonical' href = 'https://masatakashiwagi.github.io/mlops-practices/posts/2019-12-30-standardml-notes/'>
  <meta name="description" content="Hugo is a general-purpose website framework. Technically speaking, Hugo is a static site generator. Unlike systems that dynamically build a page with each visitor request, Hugo builds pages when you create or update your content. Since websites are viewed far more often than they are edited, Hugo is designed to provide an optimal viewing experience for your website’s end users and an ideal writing experience for website authors.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Standard ML notes" />
<meta property="og:description" content="Basics Comments 1(* SML comment *) Variable bindings and Expressions 1val x = 34; 2(* static environment: x : int *) 3(* dynamic environment: x --&gt; 34 *) 4val y = x &#43; 1; 5 6(* Use tilde character instead of minus to reprsent negation *) 7val z = ~1; 8 9(* Integer Division *) 10val w = y div x Strings:
1(* `\n`のようなエスケープシーケンスが利用できる *) 2val x = &#34;hello\n&#34;; 3(* 文字列の連結には&#39;^&#39;を使う *) 4val y = &#34;hello &#34; ^ &#34;world&#34;; An ML program is a sequence of bindings." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://masatakashiwagi.github.io/mlops-practices/posts/2019-12-30-standardml-notes/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-30T09:00:00+00:00" />
<meta property="article:modified_time" content="2019-12-30T09:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Standard ML notes"/>
<meta name="twitter:description" content="Basics Comments 1(* SML comment *) Variable bindings and Expressions 1val x = 34; 2(* static environment: x : int *) 3(* dynamic environment: x --&gt; 34 *) 4val y = x &#43; 1; 5 6(* Use tilde character instead of minus to reprsent negation *) 7val z = ~1; 8 9(* Integer Division *) 10val w = y div x Strings:
1(* `\n`のようなエスケープシーケンスが利用できる *) 2val x = &#34;hello\n&#34;; 3(* 文字列の連結には&#39;^&#39;を使う *) 4val y = &#34;hello &#34; ^ &#34;world&#34;; An ML program is a sequence of bindings."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://masatakashiwagi.github.io/mlops-practices/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css" integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="apple-touch-icon" sizes="180x180" href="/mlops-practices/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/mlops-practices/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/mlops-practices/favicon/favicon-16x16.png">
<link rel="manifest" href="/mlops-practices/favicon/site.webmanifest">
<link rel="mask-icon" href="/mlops-practices/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/mlops-practices/">Home</a></li>
         
        <li><a href="/mlops-practices/knowledge">Knowledge</a></li>
         
        <li><a href="/mlops-practices/tips">Tips</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://masatakashiwagi.github.io/mlops-practices/posts/2019-11-23-uipath-orchestrator/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://masatakashiwagi.github.io/mlops-practices/posts/2020-02-29-racket/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&text=Standard%20ML%20notes" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&is_video=false&description=Standard%20ML%20notes" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Standard%20ML%20notes&body=Check out this article: https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&name=Standard%20ML%20notes&description=Basics%20Comments%201%28%2a%20SML%20comment%20%2a%29%20Variable%20bindings%20and%20Expressions%201val%20x%20%3d%2034%3b%202%28%2a%20static%20environment%3a%20x%20%3a%20int%20%2a%29%203%28%2a%20dynamic%20environment%3a%20x%20--%26gt%3b%2034%20%2a%29%204val%20y%20%3d%20x%20%2b%201%3b%205%206%28%2a%20Use%20tilde%20character%20instead%20of%20minus%20to%20reprsent%20negation%20%2a%29%207val%20z%20%3d%20~1%3b%208%209%28%2a%20Integer%20Division%20%2a%29%2010val%20w%20%3d%20y%20div%20x%20Strings%3a%0a1%28%2a%20%60%5cn%60%e3%81%ae%e3%82%88%e3%81%86%e3%81%aa%e3%82%a8%e3%82%b9%e3%82%b1%e3%83%bc%e3%83%97%e3%82%b7%e3%83%bc%e3%82%b1%e3%83%b3%e3%82%b9%e3%81%8c%e5%88%a9%e7%94%a8%e3%81%a7%e3%81%8d%e3%82%8b%20%2a%29%202val%20x%20%3d%20%26%2334%3bhello%5cn%26%2334%3b%3b%203%28%2a%20%e6%96%87%e5%ad%97%e5%88%97%e3%81%ae%e9%80%a3%e7%b5%90%e3%81%ab%e3%81%af%26%2339%3b%5e%26%2339%3b%e3%82%92%e4%bd%bf%e3%81%86%20%2a%29%204val%20y%20%3d%20%26%2334%3bhello%20%26%2334%3b%20%5e%20%26%2334%3bworld%26%2334%3b%3b%20An%20ML%20program%20is%20a%20sequence%20of%20bindings." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&t=Standard%20ML%20notes" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basics">Basics</a>
      <ul>
        <li><a href="#comments">Comments</a></li>
        <li><a href="#variable-bindings-and-expressions">Variable bindings and Expressions</a></li>
        <li><a href="#shadowing">Shadowing</a></li>
        <li><a href="#function-bindings">Function Bindings</a></li>
        <li><a href="#pairs-and-other-tuples">Pairs and other Tuples</a></li>
        <li><a href="#lists">Lists</a></li>
        <li><a href="#list-functions">List Functions</a></li>
        <li><a href="#let-expressions">Let Expressions</a></li>
        <li><a href="#options">Options</a></li>
      </ul>
    </li>
    <li><a href="#some-more-expressions">Some More Expressions</a></li>
    <li><a href="#build-new-types">Build New Types</a>
      <ul>
        <li><a href="#records">Records</a></li>
        <li><a href="#datatype-bindings">Datatype bindings</a></li>
      </ul>
    </li>
    <li><a href="#case-expressions">Case Expressions</a></li>
    <li><a href="#lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</a></li>
    <li><a href="#pattern-matching">Pattern-matching</a>
      <ul>
        <li><a href="#function-patterns">Function Patterns</a></li>
      </ul>
    </li>
    <li><a href="#exceptions">Exceptions</a></li>
    <li><a href="#tail-recursion">Tail Recursion</a></li>
    <li><a href="#first-class-functions">First-class Functions</a>
      <ul>
        <li><a href="#anonymous-functions">Anonymous Functions</a></li>
        <li><a href="#lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</a></li>
        <li><a href="#combining-functions">Combining Functions</a></li>
        <li><a href="#currying">Currying</a></li>
      </ul>
    </li>
    <li><a href="#type-inference">Type Inference</a>
      <ul>
        <li><a href="#value-restriction">Value restriction</a></li>
      </ul>
    </li>
    <li><a href="#mutual-recursion">Mutual Recursion</a></li>
    <li><a href="#modules">Modules</a>
      <ul>
        <li><a href="#signatures">Signatures</a></li>
        <li><a href="#signature-matching">Signature matching</a></li>
      </ul>
    </li>
    <li><a href="#equivalence">Equivalence</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Standard ML notes
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2019-12-30 09:00:00 &#43;0000 UTC" itemprop="datePublished">2019-12-30</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          14 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/mlops-practices/categories/notes">notes</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/mlops-practices/tags/sml" rel="tag">SML</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="basics">Basics</h2>
<h3 id="comments">Comments</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* SML comment *)
</code></pre></div><h3 id="variable-bindings-and-expressions">Variable bindings and Expressions</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>val x = 34;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>(* static environment: x : int *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>(* dynamic environment: x --&gt; 34 *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>val y = x + 1;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>(* Use tilde character instead of minus to reprsent negation *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>val z = ~1;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>(* Integer Division *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>val w = y div x
</code></pre></div><p>Strings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* `\n`のようなエスケープシーケンスが利用できる *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>val x = &#34;hello\n&#34;; 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>(* 文字列の連結には&#39;^&#39;を使う *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val y = &#34;hello &#34; ^ &#34;world&#34;;
</code></pre></div><p>An ML program is a sequence of bindings. Each binding gets <strong>type-checked</strong> and then <strong>evaluated</strong>.
What type a binding has depends on a static environment. How a binding is evaluated depends on a dynamic environment.
Sometimes we use just <code>environment</code> to mean dynamic environment and use <code>context</code> as a synonym for static environment.</p>
<ul>
<li>Syntaxs : How to write it.</li>
<li>Semantics: How it type-checks and evaluates</li>
<li>Value: an expression that has no more computation to do</li>
</ul>
<h3 id="shadowing">Shadowing</h3>
<p><strong>Bindings are immutable</strong> in SML. Given <code>val x = 8 + 9;</code> we produce a dynamic environment where x maps to 17.
In this environment x will always map to 17; there is no &ldquo;assignment statement&rdquo; in ML for changing what x maps to.
You can have another binding later, say <code>val x = 19;</code>, but that just creates a differnt environment
where the later binding for x <strong>shadows</strong> the earlier one.</p>
<h3 id="function-bindings">Function Bindings</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun pow (x:int, y:int) = (* correct only for y &gt;= 0 *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    if y = 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    then 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    else x * pow(x, y-1);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>fun cube (x : int) = 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    pow(x, 3);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>val ans = cube(4);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>(* The parentheses are not necessary if there is only one argument
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>     val ans = cube 4; *)
</code></pre></div><ul>
<li>Syntax: <code>fun x0 (x1 : t1, ..., xn : tn) = e</code></li>
<li>Type-checking:
<ul>
<li><code>t1 * ... * tn -&gt; t</code></li>
<li>The type of a function is &ldquo;argument types&rdquo; -&gt; &ldquo;reslut types&rdquo;</li>
</ul>
</li>
<li>Evaluation:
<ul>
<li>A function is a value</li>
<li>The environment we extends arguments with is that “was current” when the function was defined, not the one where it is being called.</li>
</ul>
</li>
</ul>
<h3 id="pairs-and-other-tuples">Pairs and other Tuples</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun swap (pr : int*bool) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    (#2 pr, #1 pr);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>fun sum_two_pairs (pr1 : int * int, pr2 : int * int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    (#1 pr1) + (#2 pr1 ) + (#1 pr2) + (#2 pr2);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>fun div_mod (x : int, y: int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    (x div y, x mod y);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>fun sort_pair(pr : int * int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    if (#1 pr) &lt; (#2 pr) then
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>	pr
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    else
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>	(#2 pr, #1 pr);
</code></pre></div><p>ML supportstuplesby allowing any number of parts. Pairs and tuples can be nested however you want. For example, a 3-tuple (i.e., a triple) of integers has type int<em>int</em>int. An example is (7,9,11) and you retrieve the parts with #1 e, #2 e, and #3 e where e is an expression that evaluates to a triple.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val a = (7, 9, 11) (* int * int * int *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>val x = (3, (4, (5,6))); (* int * (int * (int * int)) *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>val y = (#2 x, (#1 x, #2 (#2 x))); (* (int * (int * int)) * (int * (int * int)) *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val ans = (#2 y, 4); (* (int * (int * int)) * int *)
</code></pre></div><h3 id="lists">Lists</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val x = [7,8,9];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>5::x; (* 5 consed onto x *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>6::5::x;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>[6]::[[1,2],[3,4];
</code></pre></div><p>To append a list t a list, use list-append operator <code>@</code>:
<a href="%5Bhttp://sml-family.org/Basis/list.html%5D(http://sml-family.org/Basis/list.html)">Reference：# The Standard ML Basis Library</a></p>
<blockquote>
<p>Interface:
<strong>val</strong>  <a href="http://sml-family.org/Basis/list.html#SIG:LIST.@:VAL">@</a>  <strong>:</strong>  <em>&lsquo;a</em> list *  <em>&lsquo;a</em> list <strong>-&gt;</strong>  <em>&lsquo;a</em> list</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val x = [1,2] @ [3,4,5]; (* [1,2,3,4,5] *)
</code></pre></div><p>Accessing:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val x = [7,8,9];
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>null x; (* False *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>null []; (* True *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>hd x; (* 7 *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>tl x; (* [8, 9] *)
</code></pre></div><h3 id="list-functions">List Functions</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun sum_list(xs : int list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    then 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    else hd xs + sum_list(tl xs);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>fun list_product(xs : int list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    then 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>    else hd xs * list_product(tl xs);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>fun countdown(x : int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    if x = 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    then []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    else x :: countdown(x - 1);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>fun append (xs : int lisst, ys : int list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    then ys
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    else (hd xs) :: append((tl xs), ys);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>fun sum_pair_list(xs : (int * int) list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    then 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>    else #1 (hd xs) + #2 (hd xs) + sum_pair_list(tl xs);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>fun firsts (xs : (int * int) list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>    then []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>    else (#1 (hd xs)) :: firsts(tl xs);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>fun seconds (xs : (int * int) list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>    then []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    else (#2 (hd xs)) :: seconds(tl xs);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>fun sum_pair_list2 (xs : (int * int) list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>    (sum_list(firsts xs)) + (sum_list(seconds xs));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>
</code></pre></div><p>Functions that make and us lists are almost always recursice becasue a list has an unknown length. To write a recursive function the thought process involves two steps:</p>
<ul>
<li>think about the <em>base case</em></li>
<li>think about the <em>recursive case</em></li>
</ul>
<h3 id="let-expressions">Let Expressions</h3>
<ul>
<li>Syntax: <code>let b1 b2 ... bn in e end</code>
<ul>
<li>Each <code>bi</code> is any binding an <code>e</code> is any expression</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>let val x = 1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    (let val x = 2 in x+1 end) + (let val y = x+2 in y+1 end)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>end
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>fun countup_from1 (x:int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    let fun count (from:int) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        if from=x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>        then x::[]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>        else from :: count(from+1)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>        count(1)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    end
</code></pre></div><h3 id="options">Options</h3>
<p>An option value has either 0 or 1 thing: <code>None</code> is an option value carrying nothing whereas <code>SOME e</code> evaluates e to a value v and becomes the option carrying the one value v. The type of <code>NONE</code> is <code>'a option</code> and the type of <code>SOME e</code> is <code>t option</code> if e has type t.</p>
<p>We have:</p>
<ul>
<li><code>isSome</code> which evaluates to false if its argument is NONE</li>
<li><code>valOf</code> to get the value carried by <code>SOME</code>(raising exception for <code>NONE</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun max1( xs : int list) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    if null xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    then NONE
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    else
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>	let val tl_ans = max1(tl xs)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>	in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>	    if isSome tl_ans andalso valOf tl_ans &gt; hd xs
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>	    then tl_ans
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>	    else SOME (hd xs)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>	end;
</code></pre></div><h2 id="some-more-expressions">Some More Expressions</h2>
<p>Boolean operations:</p>
<ul>
<li><code>e1 andalso e2</code>
<ul>
<li>if result of e1 is false then false else result of e2</li>
</ul>
</li>
<li><code>e1 orelse e2</code></li>
<li><code>not e1</code></li>
</ul>
<p><strong>※Syntax <code>&amp;&amp;</code> and <code>||</code> don&rsquo;t exist in ML and <code>!</code> means something different.</strong></p>
<p><strong>※<code>andalso</code> and <code>orelse</code> are just keywords. <code>not</code> is a pre-defined function.</strong></p>
<p>Comparisons:</p>
<ul>
<li><code>=</code> <code>&lt;&gt;</code> <code>&gt;</code> <code>&lt;</code> <code>&gt;=</code> <code>&lt;=</code>
<ul>
<li><code>=</code> and <code>&lt;&gt;</code> can be used with any &ldquo;equality type&rdquo; but not with real</li>
</ul>
</li>
</ul>
<h2 id="build-new-types">Build New Types</h2>
<p>To Create a compound type, there are really only three essential building blocks:</p>
<ul>
<li><strong>Each-of</strong> : A compound type t describes values that contain each of values of type <code>t1</code> <code>t2</code> &hellip; <code>tn</code></li>
<li><strong>One-of</strong>: A compound type t describes values that contain a value of one of the types <code>t1</code> <code>t2</code> &hellip; <code>tn</code></li>
<li><strong>Self-refenence</strong>: A compound type t may refer to itself in its definition in order to describe recursive data structures like lists and trees.</li>
</ul>
<h3 id="records">Records</h3>
<p>Record types are &ldquo;each-of&rdquo; types where each component is a named field. The order of fields never matters.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val x = {bar = (1+2,true andalso true), foo = 3+4, baz = (false,9) }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>#bar x (* (3, true) *)
</code></pre></div><p>Tupels are actually syntactic sugar for records. <code>#1 e</code>, <code>#2 e</code>, etc. mean: get the contents of the field named 1, 2, etc.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>- val x = {1=&#34;a&#34;,2=&#34;b&#34;};
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>val x = (&#34;a&#34;,&#34;b&#34;) : string * string
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>- val y = {1=&#34;a&#34;, 3=&#34;b&#34;};
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val y = {1=&#34;a&#34;,3=&#34;b&#34;} : {1:string, 3:string}
</code></pre></div><h3 id="datatype-bindings">Datatype bindings</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>datatype mytype = TwoInts of int*int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>		                       | Str of string
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>                               | Pizza;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val a = Str &#34;hi&#34;; (* Str &#34;hi&#34; : mytype *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>val b = Str; (* fn : string -&gt; mytype *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>val c = Pizza; (* Pizza : mytype *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>val d = TwoInts(1+2, 3+4); (* TwoInts (3,7) : mytype *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>val e = a; (* Str &#34;hi&#34; : mytype *)
</code></pre></div><p>The example above adds four things to the environment:</p>
<ul>
<li>A new type mytype that we can now use just like any other types</li>
<li>Three constructors <code>TwoInts</code>, <code>Str</code>, <code>Pizza</code></li>
</ul>
<p>We can also create a type synonmy which is entirely interchangeable with the existing type.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>type foo = int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>(* we can write foo wherever we write int and vice-versa *)
</code></pre></div><h2 id="case-expressions">Case Expressions</h2>
<p>To access to datatype values, we can use a case expression:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun f (x : mytype) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    case x of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>	    Pizza =&gt; 3
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      | Str s =&gt; 8
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>      | TwoInts(i1, i2) =&gt; i1 + i2;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>f(Str(&#34;a&#34;)); (* val it = 8 : int *)
</code></pre></div><p>We separate the branches with the <code>|</code> character. Each branch has the form <code>p =&gt; e</code> where p is a pattern and e is an expression. Patterns are used to match against the result of evaluating the case&rsquo;s first expression. This is why evaluating a case-expression is called pattern-matching.</p>
<h2 id="lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</h2>
<p><code>SOME</code> and <code>NONE</code> are actually constructors. So you can use them in a case like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun inc_or_zero intoption =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    case intoption of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>	    NONE =&gt; 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      | SOME i =&gt; i+1;
</code></pre></div><p>As for list, <code>[]</code> and <code>::</code> are also constructors. <code>::</code> is a little unusual because it is an infix operator so when in patterns:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun sum_list xs =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>	    [] =&gt; 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      | x::xs&#39; =&gt; x + sum_list xs&#39;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>fun append(xs, ys) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>	    [] =&gt; ys
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span>      | x::xs&#39; =&gt; x :: append(xs&#39;, ys);
</code></pre></div><h2 id="pattern-matching">Pattern-matching</h2>
<p>Val-bindings are actually using pattern-matching.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val (x, y, z) = (1,2,3);
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>(*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    val x = 1 : int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    val y = 2 : int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    val z = 3 : int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>*)
</code></pre></div><p>When defining a function, we can also use pattern-matching</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun sum_triple (x, y, z) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    x + y + z;
</code></pre></div><p>Actually, all functions in ML takes one tripple as an argument. There is no such thing as a mutli-argument function  or zero-argument function in ML.
The binding <code>fun () = e</code> is using the unit-pattern <code>()</code> to match against calls that pass the unit value <code>()</code>, which is the only value fo a pre-defined datatype <code>unit</code>.</p>
<p>The definition of patterns is recursive. We can use nested patterns instead of nested cae expressions.</p>
<p>We can use wildcard pattern <code>_</code> in patterns.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun len xs =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>	[] =&gt; 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      | _::xs&#39; =&gt; 1 + len xs&#39;;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>
</code></pre></div><h3 id="function-patterns">Function Patterns</h3>
<p>In a function binding, we can use a syntactic sugar instead of using case expressions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun f p1 = e1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  | f p2 = e2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  ...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  | f pn = en
</code></pre></div><p>for example</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun append ([], ys) = ys
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  | append (x::xs&#39;, ys) = x :: append(xs&#39;, ys);
</code></pre></div><h2 id="exceptions">Exceptions</h2>
<p>To create new kinds of exceptions we can use exception bindings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>exception MyUndesirableCondition;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>exception MyOtherException of int * int;
</code></pre></div><p>Use <code>raise</code> to raise exceptions. Use <code>handle</code> to catch exceptions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun hd xs =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	[] =&gt; raise List.Empty
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>      | x::_ =&gt; x;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>(* The type of maxlist will be int list * exn -&gt; int *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>fun maxlist(xs, ex) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>	[] =&gt; raise ex
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>      | x::[] =&gt; x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>      | x::xs&#39; =&gt; Int.max(x, maxlist(xs&#39;, ex));
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>(* e1 handle ex =&gt; e2 *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>val y = maxlist([], MyUndesirableCondition)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>	handle MyUndesirableCondition =&gt; 42;
</code></pre></div><h2 id="tail-recursion">Tail Recursion</h2>
<p>There is a situation in a recursive call called <strong>tail call</strong>:</p>
<blockquote>
<p>when f makes a recursive call to f, there is nothing more for the caller to do after the callee returns except return the callee&rsquo;s result.</p>
</blockquote>
<p>Consider a sum function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun sum1 xs =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>        [] =&gt; 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>      | i::xs&#39; =&gt; i + sum1 xs&#39;
</code></pre></div><p>When the function runs, it will keep a call-stack for each recursive call . But if we change a little bit using tail call :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun sum2 xs =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    let fun f (xs,acc) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>        case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>            [] =&gt; acc
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>          | i::xs&#39; =&gt; f(xs&#39;,i+acc)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>    in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>        f(xs,0)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span>    end
</code></pre></div><p>we use a local helper <code>f</code> and a accumulator <code>acc</code> so that the return value  of <code>f</code>  is just the return value of <code>sum2</code> . As a result, there is no need to keep every call in stack, just the current <code>f</code> is enough. And that&rsquo;s ML and most of other functional programming languages do.
Another example: when reversing a list:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>fun rev1 lst =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>    case lst of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>        [] =&gt; []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>      | x::xs =&gt; (rev1 xs) @ [x]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>fun rev2 lst =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    let fun aux(lst,acc) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>	    case lst of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>		[] =&gt; acc
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>	      | x::xs =&gt; aux(xs, x::acc)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    in
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>	aux(lst,[])
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    end
</code></pre></div><p><code>rev1</code> is <code>O(n^2)</code> but rev2 is almost as simple as <code>O(n)</code>.</p>
<p>To make sure which calls are tail calls, we can use a recursive defination of <strong>tail position</strong> like:</p>
<ul>
<li>In <code>fun f(x) = e</code>, <code>e</code> is in tail position.</li>
<li>If an expression is not in tail position, then none of its subexpressions are</li>
<li>If <code>if e1 then e2 else e3</code> is in tail position, then <code>e2</code> and <code>e3</code> are in tail position (but not <code>e1</code>). (Case-expressions are similar.)</li>
<li>If <code>let b1 ... bn in e end</code> is in tail position, then e is in tail position (but no expressions in the bindings are).</li>
<li>Function-call arguments are not in tail position.</li>
</ul>
<h2 id="first-class-functions">First-class Functions</h2>
<p>The most common use of first class functions is passing them as arguments to other functions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun n_times (f, n, x) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    if n=0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    then x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    else f (n_times(f, n-1,x))
</code></pre></div><p>The function <code>n_times</code> is called higher-order funciton.  Its type is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fn : (&#39;a -&gt; &#39;a) * int * &#39;a -&gt; &#39;a
</code></pre></div><p><code>'a</code> means they can be any type. This is called <em>parametric polymorphism</em> , or <em>generic types</em> .</p>
<p>Instead, consider a function that is not polymorphic:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* (int -&gt; int) * int -&gt; int *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>fun times_until_zero (f, x) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    if x = 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>    then 0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>    else 1 + times_until_zero(f, f x)
</code></pre></div><h3 id="anonymous-functions">Anonymous Functions</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun triple_n_times (n, x) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>    n_times((fn x =&gt; 3*x), n, x)
</code></pre></div><p>Maps:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* (&#39;a -&gt; &#39;b) * &#39;a list -&gt; &#39;b list *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>fun map (f, xs) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>	[] =&gt; []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>      | x::xs&#39; =&gt; (f x)::(map(f, xs&#39;));
</code></pre></div><p>Filters:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* (&#39;a -&gt; bool) * &#39;a list -&gt; &#39;a list *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>fun filter (f, xs) =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>    case xs of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>	[] =&gt; []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>      | x::xs&#39; =&gt; if f x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>		  then x::(filter (f, xs&#39;))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>		  else filter (f, xs&#39;);
</code></pre></div><h3 id="lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</h3>
<h3 id="combining-functions">Combining Functions</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span> fun sqrt_of_abs i = (Math.sqrt o Real.fromInt o abs) i;
</code></pre></div><p>Use our own infix operator to define a left-to-right syntax.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>infix |&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>fun x |&gt; f = f x;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>fun sqrt_of_abs i = i |&gt; abs |&gt; Real.fromInt |&gt; Math.sqrt;
</code></pre></div><h3 id="currying">Currying</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* fun sorted(x, y z) = z &gt;= y andalso y &gt;= x *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>val sorted = fn x =&gt; fn y =&gt; fn z =&gt; z &gt;= y andalso y &gt;= x;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>(* just syntactic sugar for code above *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>fun sorted_nicer x y z = z &gt;= y andalso y &gt;= x;
</code></pre></div><p>when calling curried the function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>(* ((sorted_nicer x) y) z *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>(* or just: *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>sorted_nicer x y z
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>
</code></pre></div><h2 id="type-inference">Type Inference</h2>
<p>Key steps in ML:</p>
<ul>
<li>Determine types of bindings in order</li>
<li>For each val of fun binding:
<ul>
<li>Analyze definition for all necessary facts</li>
<li>Type erro if no way for all facts to hold</li>
</ul>
</li>
<li>Use type variables like <code>'a</code> for any unconstrained type</li>
<li>Enforce the value restriction</li>
</ul>
<p>One example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>(*
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>	compose : T1 * T2 -&gt; T3
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>	f : T1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>	g : T2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>	x : T4
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>	body being a function has type T3=T4-&gt;T5
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>	from g being passed x, T2=T4-&gt;T6 for some T6
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>	from f being passed the result of g, T1=T6-&gt;T7
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>	from call to f being body of anonymous function, T7 = T5
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>	all together, (T6-&gt;T5) * (T4-&gt;T6) -&gt; (T4-&gt;T5)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>	so (&#39;a-&gt;&#39;b) * (&#39;c-&gt;&#39;a) -&gt; (&#39;c-&gt;&#39;b) 
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>*)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>fun compose (f, g) = fn x =&gt; f (g x)
</code></pre></div><h3 id="value-restriction">Value restriction</h3>
<p>A variable-binding can have a polymorphic type only if the expression is a variable or value:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>val r = ref NONE
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>val _ = r := SOME &#34;hi&#34;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>val i - 1 + valOf (!r)
</code></pre></div><p>If there is is no value-restriction, the code above will type check, which shouldn&rsquo;t.
With value restriction, ML will give a warning when type-checking:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>- val r = ref NONE;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>stdIn:2.5-2.17 Warning: type vars not generalized because of
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>   value restriction are instantiated to dummy types (X1,X2,...)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val r = ref NONE : ?.X1 option ref
</code></pre></div><h2 id="mutual-recursion">Mutual Recursion</h2>
<p>Mutual recursion allows <code>f</code> to call <code>g</code> and <code>g</code> to call <code>f</code>.
In ML, There is an <code>and</code> keyword to allow that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>fun p1 = e1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>and p2 = e2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>and p3 = p3
</code></pre></div><h2 id="modules">Modules</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>structure MyMathLib =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>struct
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>fun fact x = x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>val half_pi = Math.pi / 2.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>fun doubler x = x * 2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>end
</code></pre></div><h3 id="signatures">Signatures</h3>
<p>A signature is a type for a module.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>signature SIGNAME  =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>sig types-for-bindings
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>end
</code></pre></div><p>Ascribing a signature to a module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>structure myModule :&gt; SIGNAME =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>struct bindings end;
</code></pre></div><p>Anything not in the signature cannot be used outside the module.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>signature MATHLIB =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>sig
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    val fact : int -&gt; int
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    val half_pi : real
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    (* make doubler unaccessable outside the MyMathLib *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    (* val doubler : int -&gt; int *)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>end
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>structure MyMathLib :&gt; MATHLIB =
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>struct
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>fun fact x = x
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>val half_pi = Math.pi / 2.0
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>fun doubler x = x * 2
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>end 
</code></pre></div><h3 id="signature-matching">Signature matching</h3>
<h2 id="equivalence">Equivalence</h2>
<ul>
<li>PL Equivalence</li>
<li>Asymptotic equivalence</li>
<li>System equivalence</li>
</ul>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/mlops-practices/">Home</a></li>
         
          <li><a href="/mlops-practices/knowledge">Knowledge</a></li>
         
          <li><a href="/mlops-practices/tips">Tips</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basics">Basics</a>
      <ul>
        <li><a href="#comments">Comments</a></li>
        <li><a href="#variable-bindings-and-expressions">Variable bindings and Expressions</a></li>
        <li><a href="#shadowing">Shadowing</a></li>
        <li><a href="#function-bindings">Function Bindings</a></li>
        <li><a href="#pairs-and-other-tuples">Pairs and other Tuples</a></li>
        <li><a href="#lists">Lists</a></li>
        <li><a href="#list-functions">List Functions</a></li>
        <li><a href="#let-expressions">Let Expressions</a></li>
        <li><a href="#options">Options</a></li>
      </ul>
    </li>
    <li><a href="#some-more-expressions">Some More Expressions</a></li>
    <li><a href="#build-new-types">Build New Types</a>
      <ul>
        <li><a href="#records">Records</a></li>
        <li><a href="#datatype-bindings">Datatype bindings</a></li>
      </ul>
    </li>
    <li><a href="#case-expressions">Case Expressions</a></li>
    <li><a href="#lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</a></li>
    <li><a href="#pattern-matching">Pattern-matching</a>
      <ul>
        <li><a href="#function-patterns">Function Patterns</a></li>
      </ul>
    </li>
    <li><a href="#exceptions">Exceptions</a></li>
    <li><a href="#tail-recursion">Tail Recursion</a></li>
    <li><a href="#first-class-functions">First-class Functions</a>
      <ul>
        <li><a href="#anonymous-functions">Anonymous Functions</a></li>
        <li><a href="#lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</a></li>
        <li><a href="#combining-functions">Combining Functions</a></li>
        <li><a href="#currying">Currying</a></li>
      </ul>
    </li>
    <li><a href="#type-inference">Type Inference</a>
      <ul>
        <li><a href="#value-restriction">Value restriction</a></li>
      </ul>
    </li>
    <li><a href="#mutual-recursion">Mutual Recursion</a></li>
    <li><a href="#modules">Modules</a>
      <ul>
        <li><a href="#signatures">Signatures</a></li>
        <li><a href="#signature-matching">Signature matching</a></li>
      </ul>
    </li>
    <li><a href="#equivalence">Equivalence</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&text=Standard%20ML%20notes" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&is_video=false&description=Standard%20ML%20notes" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Standard%20ML%20notes&body=Check out this article: https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&name=Standard%20ML%20notes&description=Basics%20Comments%201%28%2a%20SML%20comment%20%2a%29%20Variable%20bindings%20and%20Expressions%201val%20x%20%3d%2034%3b%202%28%2a%20static%20environment%3a%20x%20%3a%20int%20%2a%29%203%28%2a%20dynamic%20environment%3a%20x%20--%26gt%3b%2034%20%2a%29%204val%20y%20%3d%20x%20%2b%201%3b%205%206%28%2a%20Use%20tilde%20character%20instead%20of%20minus%20to%20reprsent%20negation%20%2a%29%207val%20z%20%3d%20~1%3b%208%209%28%2a%20Integer%20Division%20%2a%29%2010val%20w%20%3d%20y%20div%20x%20Strings%3a%0a1%28%2a%20%60%5cn%60%e3%81%ae%e3%82%88%e3%81%86%e3%81%aa%e3%82%a8%e3%82%b9%e3%82%b1%e3%83%bc%e3%83%97%e3%82%b7%e3%83%bc%e3%82%b1%e3%83%b3%e3%82%b9%e3%81%8c%e5%88%a9%e7%94%a8%e3%81%a7%e3%81%8d%e3%82%8b%20%2a%29%202val%20x%20%3d%20%26%2334%3bhello%5cn%26%2334%3b%3b%203%28%2a%20%e6%96%87%e5%ad%97%e5%88%97%e3%81%ae%e9%80%a3%e7%b5%90%e3%81%ab%e3%81%af%26%2339%3b%5e%26%2339%3b%e3%82%92%e4%bd%bf%e3%81%86%20%2a%29%204val%20y%20%3d%20%26%2334%3bhello%20%26%2334%3b%20%5e%20%26%2334%3bworld%26%2334%3b%3b%20An%20ML%20program%20is%20a%20sequence%20of%20bindings." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmasatakashiwagi.github.io%2fmlops-practices%2fposts%2f2019-12-30-standardml-notes%2f&t=Standard%20ML%20notes" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  masatakashiwagi 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/mlops-practices/">Home</a></li>
         
        <li><a href="/mlops-practices/knowledge">Knowledge</a></li>
         
        <li><a href="/mlops-practices/tips">Tips</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/mlops-practices/lib/font-awesome/css/all.min.css>
<script src=/mlops-practices/lib/jquery/jquery.min.js></script>
<script src=/mlops-practices/js/main.js></script>

<script src=/mlops-practices/js/code-copy.js></script>




</html>
